!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("picTune",[],e):"object"==typeof exports?exports.picTune=e():t.picTune=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(i){if(r[i])return r[i].exports;var o=r[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){function e(){u=!1,c=!1,clearTimeout(p)}function r(){var e=n.width,r=n.height,i=parseFloat((e/r).toFixed(2)),a=o.style,u=s.style;a.width=e+l+"px",a.height=r+l+"px";var c=o.clientWidth-l,d=o.clientHeight-l,f=parseFloat((c/d).toFixed(2));if(i!=f&&(f>i?a.width=d*i+l+"px":a.height=c/i+l+"px"),"block"==u.display){var p=t.cropRate;u.left=u.top=0,u.width=u.height="100%",p&&i!=p&&(i>p?u.width=s.clientHeight*p+l+"px":u.height=s.clientWidth/p+l+"px"),Object(h.c)(t.onMovingCrop,t,[])}}var i=t.wrapper,o=t.source,n=t.picture,a=(t.showImage,t.canvas),s=t.crop,u=!1,c=!1,d={left:0,top:0,width:0,height:0},f="",p=0,g=s.getElementsByTagName("div"),m=["lt","rt","lb","rb"];s.onmousedown=function(t){var r=t.toElement;d.left=o.clientWidth-s.offsetWidth,d.top=o.clientHeight-s.offsetHeight,d.width=o.clientWidth,d.height=o.clientHeight,u=!0;for(var i=0,n=g.length;i<n;++i)if(g[i]===r){f=m[i],u=!1,c=!0;break}clearTimeout(p),p=setTimeout(e,1e3)},i.onmousemove=function(r){var i=s.style,o=r.movementX,n=r.movementY,a=s.offsetLeft,g=s.offsetTop,m=void 0,v=void 0,x=void 0,y=void 0,w=t.cropRate;if(u)m=a+o,v=g+n,m=m<0?0:m>d.left?d.left:m,v=v<0?0:v>d.top?d.top:v,m!=a&&(i.left=m+"px"),v!=g&&(i.top=v+"px"),Object(h.c)(t.onMovingCrop,t,[]);else if(c){var E=s.offsetWidth,b=s.offsetHeight;if(w){var T="lt"==f||"rb"==f?1:-1;w>1?o=T*n*w:n=T*o/w}-1!=f.indexOf("l")?(m=a+o,x=E-o,m<0&&(x+=m,m=0,w&&(y=(x-l)/w+l))):(x=E+o)+a>d.width&&(x=d.width-a,w&&(y=(x-l)/w+l)),-1==f.indexOf("t")||y?y||(y=b+n)+g>d.height&&(y=d.height-g,w&&(x=(y-l)*w+l)):(v=g+n,y=b-n,v<0&&(y+=v,v=0,w&&(x=(y-l)*w+l))),isNaN(m)&&(m=a),isNaN(v)&&(v=g),w&&(m+x<d.width?y=(x-l)/w+l:v+y<d.height&&(x=(y-l)*w+l)),m!=a&&(i.left=m+"px"),v!=g&&(i.top=v+"px"),x!=E&&(i.width=x+"px"),y!=b&&(i.height=y+"px"),Object(h.c)(t.onMovingCrop,t,[])}clearTimeout(p),p=setTimeout(e,1e3)},i.onmouseup=e,n.onload=function(t){r(),s.style.display="none",a.draw(a.texture(this)).update()},n.error=function(t){console.log(t)},window.onresize=function(t){r()}}Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),a=(r.n(n),r(6)),s=r(7),h=r(8),u=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),l=4,c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),Object.assign(this,{id:"",element:"",width:"",height:"400px",url:"",output:"",file:{},onMovingCrop:function(){}},e);var r=this.element||document.getElementById(this.id),n=document.createElement("div"),a=document.createElement("img"),h=document.createElement("img"),u=s.a.canvas(),l=document.createElement("div"),c=new Image;this.wrapper=r,this.source=n,this.picture=a,this.showImage=h,this.canvas=u,this.crop=l,this.originImage=c,r.className="image-editor-wrapper",n.className="image-editor-source",a.className="image-editor-picture",h.className="image-editor-show",h.style.display="none",u.className="image-editor-canvas",u.innerText="你的浏览器不支持HTML5.",l.style.display="none",l.className="image-editor-crop",l.innerHTML='<div class="editor-crop-left editor-crop-top"></div><div class="editor-crop-right editor-crop-top"></div><div class="editor-crop-left editor-crop-bottom"></div><div class="editor-crop-right editor-crop-bottom"></div>',n.appendChild(a),n.appendChild(u),n.appendChild(h),n.appendChild(l),r.appendChild(n),this.width&&(r.style.width=this.width),this.height&&(r.style.height=this.height,r.style["line-height"]=this.height),e.url&&this.loadAsUrl(e.url),o(this)}return u(t,[{key:"loadAsUrl",value:function(t){var e=this;return h.b.get({url:t,type:"blob"}).then(function(t){return e.loadAsFile(t)})}},{key:"loadAsFile",value:function(t){var e=this,r=new FileReader,i=new Promise(function(i,o){r.onload=function(o){e.confirm(r.result),e.file=t,e.showImage.style.display="image/gif"==t.type?"block":"none",i()}});return r.readAsDataURL(t),i}},{key:"confirm",value:function(t){t=t||this.canvas.toDataURL(this.output||this.file.type),this.picture.src=t,this.originImage.src=t,this.showImage.src=t}},{key:"reset",value:function(){this.picture.src=this.originImage.src}},{key:"getSize",value:function(){var t=this.canvas;return{width:t.width,height:t.height}}},{key:"toggleCrop",value:function(t,e){var r=this.crop,i=this.cropRate=parseFloat((e||0).toFixed(2)),o=r.style,n="block"==o.display;if(void 0===t&&(t=!n),t&&(this.showImage.style.display="none"),o.display=t?"block":"none",o.left=o.top=0,o.width=o.height="100%",t&&i){var a=r.clientWidth,s=r.clientHeight,h=parseFloat((a/s).toFixed(2));h!=i&&(h>i?o.width=s*i+l+"px":o.height=a/i+l+"px")}return t}},{key:"get2dCanvas",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments[2],i=arguments[3],o=document.createElement("canvas"),n=this.picture;return r=r||n.width,i=i||n.height,o.width=r,o.height=i,o.getContext("2d").drawImage(n,t,e,r,i,0,0,r,i),o}},{key:"getCropPosition",value:function(){var t=this.crop,e=this.picture.height/this.canvas.clientHeight;return"none"==t.style.display?{top:0,left:0,height:this.picture.height,width:this.picture.width}:{top:parseInt(t.offsetTop*e),left:parseInt(t.offsetLeft*e),height:parseInt((t.offsetHeight-l)*e),width:parseInt((t.offsetWidth-l)*e)}}},{key:"setCrop",value:function(){var t=this.getCropPosition();this.confirm(this.get2dCanvas(t.left,t.top,t.width,t.height).toDataURL(this.output||this.file.type))}},{key:"rotate",value:function(t,e){var r=this.picture;this.showImage.style.display="none";var i=this.get2dCanvas(),o=i.getContext("2d"),n=r.width,a=r.height,s=0,u=0;if((t=t%360+(t<0?360:0))>0){var l=t*Math.PI/180,c=Math.abs(Math.sin(l).toFixed(2)),d=Math.abs(Math.cos(l).toFixed(2));i.width=a*c+n*d,i.height=a*d+n*c,t<=90?(s=a*c*d,u=-a*c*c):t>90&&t<=180?(s=-n*d*d,u=-(n*d*c+a)):t>180&&t<=270?(s=-(a*d*c+n),u=-a*d*d):(s=-n*c*c,u=-n*c*d),o.rotate(l)}o.drawImage(r,s,u),e&&Object(h.d)(i,e),this.picture.src=i.toDataURL(this.output||this.file.type)}},{key:"base",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this.canvas;this.showImage.style.display="none",o.draw(o.texture(this.originImage)).brightnesscontrastSaturationBur([t,e,r,i]).update()}},{key:"huaColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this.canvas;this.showImage.style.display="none",o.draw(o.texture(this.originImage)).hueColor([t,e,r,i]).update()}},{key:"getData",value:function(t,e,r){var i=this.picture,o=this.getCropPosition(),n=this.output||this.file.type,s=this.get2dCanvas(o.left,o.top,o.width,o.height),u=null;return t=t||i.width,e=e||i.height,u=t!=o.width||e!=o.height?Object(a.a)({width:parseInt(t),height:parseInt(e)},s).toDataURL(n):s.toDataURL(n),r&&(u=Object(h.a)(u,n)),u}},{key:"download",value:function(t,e){var r=this.originImage,i=document.createElement("a"),o=document.createEvent("MouseEvents"),n=(this.output||this.file.type).split("/")[1]||"jpg";t=t||r.width,e=e||r.height,i.href=this.getData(t,e),i.download=t+"x"+e+"."+n,o.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0),i.dispatchEvent(o)}},{key:"upload",value:function(t){var e=new FormData,r=t.formKey||"fileToUpload",i={url:t.url,type:"json",data:e};return t.isOrigin?e.append(r,this.file):e.append(r,this.getData(t.width,t.height,!0)),h.b.post(i)}}]),t}();e.default=c,"undefined"!=typeof window&&window.Vue&&(window.PicTune=c)},function(t,e,r){var i=r(2);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);r(4)("6abb4a33",i,!0,{})},function(t,e,r){e=t.exports=r(3)(!1),e.push([t.i,'.image-editor-wrapper{user-select:none;position:relative;text-align:center;width:100%;min-height:400px;line-height:400px;overflow:hidden;background-color:#fff}.image-editor-source{position:relative;display:inline-block;max-width:90%;max-height:80%;vertical-align:middle}.image-editor-picture{position:absolute;left:2px;top:2px;visibility:hidden}.image-editor-canvas,.image-editor-show{position:absolute;left:2px;top:2px;width:calc(100% - 4px);height:calc(100% - 4px)}.image-editor-crop{position:absolute;left:0;top:0;width:100%;height:100%;cursor:move}.image-editor-crop:before{position:absolute;content:" ";left:-1px;top:-1px;width:100%;height:100%;border:1px solid #ff8181}.image-editor-crop:after{display:block;margin:1px;content:" ";width:calc(100% - 4px);height:calc(100% - 4px);border:1px solid #ff8181}.image-editor-crop div{position:absolute;width:10px;height:10px;border-radius:10px;border:2px solid #f2060d;background-color:#e6b9b9}.editor-crop-left{left:-6px}.editor-crop-right{right:-6px}.editor-crop-top{top:-6px}.editor-crop-bottom{bottom:-6px}.editor-crop-left.editor-crop-top{cursor:nw-resize}.editor-crop-left.editor-crop-bottom{cursor:sw-resize}.editor-crop-right.editor-crop-top{cursor:ne-resize}.editor-crop-right.editor-crop-bottom{cursor:se-resize}',""])},function(t,e){function r(t,e){var r=t[1]||"",o=t[3];if(!o)return r;if(e&&"function"==typeof btoa){var n=i(o);return[r].concat(o.sources.map(function(t){return"/*# sourceURL="+o.sourceRoot+t+" */"})).concat([n]).join("\n")}return[r].join("\n")}function i(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=r(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},o=0;o<this.length;o++){var n=this[o][0];"number"==typeof n&&(i[n]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&i[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),e.push(a))}},e}},function(t,e,r){function i(t){for(var e=0;e<t.length;e++){var r=t[e],i=l[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(n(r.parts[o]));i.parts.length>r.parts.length&&(i.parts.length=r.parts.length)}else{for(var a=[],o=0;o<r.parts.length;o++)a.push(n(r.parts[o]));l[r.id]={id:r.id,refs:1,parts:a}}}}function o(){var t=document.createElement("style");return t.type="text/css",c.appendChild(t),t}function n(t){var e,r,i=document.querySelector("style["+v+'~="'+t.id+'"]');if(i){if(p)return g;i.parentNode.removeChild(i)}if(x){var n=f++;i=d||(d=o()),e=a.bind(null,i,n,!1),r=a.bind(null,i,n,!0)}else i=o(),e=s.bind(null,i),r=function(){i.parentNode.removeChild(i)};return e(t),function(i){if(i){if(i.css===t.css&&i.media===t.media&&i.sourceMap===t.sourceMap)return;e(t=i)}else r()}}function a(t,e,r,i){var o=r?"":i.css;if(t.styleSheet)t.styleSheet.cssText=y(e,o);else{var n=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(n,a[e]):t.appendChild(n)}}function s(t,e){var r=e.css,i=e.media,o=e.sourceMap;if(i&&t.setAttribute("media",i),m.ssrId&&t.setAttribute(v,e.id),o&&(r+="\n/*# sourceURL="+o.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var h="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!h)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var u=r(5),l={},c=h&&(document.head||document.getElementsByTagName("head")[0]),d=null,f=0,p=!1,g=function(){},m=null,v="data-vue-ssr-id",x="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());t.exports=function(t,e,r,o){p=r,m=o||{};var n=u(t,e);return i(n),function(e){for(var r=[],o=0;o<n.length;o++){var a=n[o],s=l[a.id];s.refs--,r.push(s)}e?(n=u(t,e),i(n)):n=[];for(var o=0;o<r.length;o++){var s=r[o];if(0===s.refs){for(var h=0;h<s.parts.length;h++)s.parts[h]();delete l[s.id]}}}};var y=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t,e){for(var r=[],i={},o=0;o<e.length;o++){var n=e[o],a=n[0],s=n[1],h=n[2],u=n[3],l={id:t+":"+o,css:s,media:h,sourceMap:u};i[a]?i[a].parts.push(l):r.push(i[a]={id:a,parts:[l]})}return r}},function(t,e,r){"use strict";function i(t,e,r,i){function n(){k="object"===(void 0===r?"undefined":o(r))?r:e.src||i?s:document.createElement("canvas"),k.width=f,k.height=p,j=k.getContext("2d")}function a(t){if(t){var e,r=j.getImageData(0,0,f,p),i=r.data;for(e=0;e<it;e+=4)i[e]=t[e]*ot|0,i[e+1]=t[e+1]*ot|0,i[e+2]=t[e+2]*ot|0,i[e+3]=u?t[e+3]*ot|0:255;return r}return j.getImageData(0,0,f,p)}e||(e=t.input,r=t.output,i=t.inputRemovable,t.scale&&(t=t.scale));var s,h,u=!0;if(e.src)if(s=document.createElement("canvas"),null!=e.naturalWidth)s.width=e.naturalWidth,s.height=e.naturalHeight;else if(null!=e.runtimeStyle){var l=e.runtimeStyle,c=l.width,d=l.height;l.width="auto",l.height="auto",s.width=e.width,s.height=e.height,l.width=c,l.height=d}else{var c=e.width,d=e.height;e.removeAttribute&&(e.removeAttribute("width"),e.removeAttribute("height")),s.width=e.width,s.height=e.height,e.width=c,e.height=d}else s=e;h=s.getContext("2d"),e.src&&h.drawImage(e,0,0);var f,p,g=s.width,m=s.height,v=h.getImageData(0,0,g,m).data;if(!g||!m)return!1;(e.src||i)&&s.clearRect(0,0,g,m),"object"===(void 0===t?"undefined":o(t))?t.width?(f=t.width+.5|0,p=t.height+.5|0):(f=g*t.scaleX+.5|0,p=m*t.scaleY+.5|0):(f=t*g+.5|0,p=t*m+.5|0);var x,y,w,E,b,T,R,_,A,D,C,U,S,F,I,B,P,O,L,N,G,M,X,k,j,W,H,Y,z,V,$,q,J,K,Q,Z=f<<2,tt=g<<2,et=0,rt=0,it=Z*p,ot=255.99/255,nt=f/g,at=p/m,st=nt*at;if(nt>1||at>1){var ht=function(t,e,r,i,o){return.5*(i-e+(2*e-5*r+4*i-o+(3*(r-i)+o-e)*t)*t)*t+r};for(n(),W=a(),H=W.data,E=0;E<p;E++)for(y=E/at,A=0|y,M=y-A,z=A*tt,Y=A<1?z:z-tt,A<m-2?(V=z+tt,$=(A+2)*tt):V=$=A>m-2?z:z+tt,w=0;w<f;w++,rt+=4)x=w/nt,_=0|x,X=x-_,J=_<<2,q=_<1?J:J-4,_<g-2?(K=J+4,Q=J+8):K=Q=_>g-2?J:J+4,O=ht(M,ht(X,v[Y+q],v[Y+J],v[Y+K],v[Y+Q]),ht(X,v[z+q],v[z+J],v[z+K],v[z+Q]),ht(X,v[V+q],v[V+J],v[V+K],v[V+Q]),ht(X,v[$+q],v[$+J],v[$+K],v[$+Q]))*ot|0,++q,++J,++K,++Q,L=ht(M,ht(X,v[Y+q],v[Y+J],v[Y+K],v[Y+Q]),ht(X,v[z+q],v[z+J],v[z+K],v[z+Q]),ht(X,v[V+q],v[V+J],v[V+K],v[V+Q]),ht(X,v[$+q],v[$+J],v[$+K],v[$+Q]))*ot|0,++q,++J,++K,++Q,N=ht(M,ht(X,v[Y+q],v[Y+J],v[Y+K],v[Y+Q]),ht(X,v[z+q],v[z+J],v[z+K],v[z+Q]),ht(X,v[V+q],v[V+J],v[V+K],v[V+Q]),ht(X,v[$+q],v[$+J],v[$+K],v[$+Q]))*ot|0,H[rt]=O>=0?O<256?O:255:0,H[rt+1]=L>=0?L<256?L:255:0,H[rt+2]=N>=0?N<256?N:255:0,u?(++q,++J,++K,++Q,G=ht(M,ht(X,v[Y+q],v[Y+J],v[Y+K],v[Y+Q]),ht(X,v[z+q],v[z+J],v[z+K],v[z+Q]),ht(X,v[V+q],v[V+J],v[V+K],v[V+Q]),ht(X,v[$+q],v[$+J],v[$+K],v[$+Q]))*ot|0,H[rt+3]=G>=0?G<256?G:255:0):H[rt+3]=255}else{if(Float32Array)P=new Float32Array(it);else for(P=[],rt=0;rt<it;++rt)P[rt]=0;for(y=0;y<m;y++)for(E=y*at,R=0|E,b=R*Z,B=!!((R-(E+at|0))*(m-1-y))<<1,B&&(S=R+1-E,F=E+at-R-1),x=0;x<g;x++,et+=4)switch(w=x*nt,T=0|w,rt=b+(T<<2),I=!!((T-(w+nt|0))*(g-1-x)),I&&(C=T+1-w,U=w+nt-T-1),O=v[et],L=v[et+1],N=v[et+2],u&&(G=v[et+3]),I+B){case 0:P[rt]+=O*st,P[rt+1]+=L*st,P[rt+2]+=N*st,u&&(P[rt+3]+=G*st);break;case 1:D=C*at,P[rt]+=O*D,P[rt+1]+=L*D,P[rt+2]+=N*D,u&&(P[rt+3]+=G*D),D=U*at,P[rt+4]+=O*D,P[rt+5]+=L*D,P[rt+6]+=N*D,u&&(P[rt+7]+=G*D);break;case 2:D=nt*S,P[rt]+=O*D,P[rt+1]+=L*D,P[rt+2]+=N*D,u&&(P[rt+3]+=G*D),D=nt*F,rt+=Z,P[rt]+=O*D,P[rt+1]+=L*D,P[rt+2]+=N*D,u&&(P[rt+3]+=G*D);break;default:D=C*S,P[rt]+=O*D,P[rt+1]+=L*D,P[rt+2]+=N*D,u&&(P[rt+3]+=G*D),D=U*S,P[rt+4]+=O*D,P[rt+5]+=L*D,P[rt+6]+=N*D,u&&(P[rt+7]+=G*D),D=C*F,rt+=Z,P[rt]+=O*D,P[rt+1]+=L*D,P[rt+2]+=N*D,u&&(P[rt+3]+=G*D),D=U*F,P[rt+4]+=O*D,P[rt+5]+=L*D,P[rt+6]+=N*D,u&&(P[rt+7]+=G*D)}n(),W=a(P)}if(j.putImageData(W,0,0),"string"==typeof r){if("png"===r||"jpeg"===r){var ut;return ut=i&&e.src?e:new Image,ut.width=f,ut.height=p,ut.src=k.toDataURL("image/"+r,1),ut}if("png-src"===r||"jpeg-src"===r)return k.toDataURL("image/"+r.split("-")[0],1)}return k}e.a=i;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var i=function(){function t(t,e,r){return Math.max(t,Math.min(e,r))}function e(t){return{_:t,loadContentsOf:function(t){p=this._.gl,this._.loadContentsOf(t)},destroy:function(){p=this._.gl,this._.destroy()}}}function r(t){return e(v.fromElement(t))}function i(t,e){var r=p.UNSIGNED_BYTE;if(p.getExtension("OES_texture_float")&&p.getExtension("OES_texture_float_linear")){var i=new v(100,100,p.RGBA,p.FLOAT);try{i.drawTo(function(){r=p.FLOAT})}catch(t){}i.destroy()}this._.texture&&this._.texture.destroy(),this._.spareTexture&&this._.spareTexture.destroy(),this.width=t,this.height=e,this._.texture=new v(t,e,p.RGBA,r),this._.spareTexture=new v(t,e,p.RGBA,r),this._.extraTexture=this._.extraTexture||new v(0,0,p.RGBA,r),this._.flippedShader=this._.flippedShader||new m(null,"\t        uniform sampler2D texture;\t        varying vec2 texCoord;\t        void main() {\t            gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));\t        }\t    "),this._.isInitialized=!0}function o(t,e,r){return this._.isInitialized&&t._.width==this.width&&t._.height==this.height||i.call(this,e||t._.width,r||t._.height),t._.use(),this._.texture.drawTo(function(){m.getDefaultShader().drawRect()}),this}function n(){return this._.texture.use(),this._.flippedShader.drawRect(),this}function a(t,e,r,i){(r||this._.texture).use(),this._.spareTexture.drawTo(function(){t.uniforms(e).drawRect()}),this._.spareTexture.swapWith(i||this._.texture)}function s(t){return t.parentNode.insertBefore(this,t),t.parentNode.removeChild(t),this}function h(){var t=new v(this._.texture.width,this._.texture.height,p.RGBA,p.UNSIGNED_BYTE);return this._.texture.use(),t.drawTo(function(){m.getDefaultShader().drawRect()}),e(t)}function u(){var t=this._.texture.width,e=this._.texture.height,r=new Uint8Array(t*e*4);return this._.texture.drawTo(function(){p.readPixels(0,0,t,e,p.RGBA,p.UNSIGNED_BYTE,r)}),r}function l(t){return function(){return p=this._.gl,t.apply(this,arguments)}}function c(e){var r=e[0],i=e[1],o=e[2],n=e[3];return p.hueColor=p.hueColor||new m(null,"\t        uniform sampler2D texture;\t        uniform float hue;\t        uniform float greenRed;\t        uniform float purpleGreen;\t        uniform float yellowBlue;\t        varying vec2 texCoord;\t        void main() {\t            vec4 color = texture2D(texture, texCoord);\t            \t            /* hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}] */\t            float angle = hue * 3.14159265;\t            float s = sin(angle), c = cos(angle);\t            vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\t            float len = length(color.rgb);\t            color.rgb = vec3(\t                dot(color.rgb, weights.xyz),\t                dot(color.rgb, weights.zxy),\t                dot(color.rgb, weights.yzx)\t            );\t            color.r += greenRed; \t            color.g -= greenRed; \t            color.b -= greenRed; \t            color.r -= purpleGreen; \t            color.g += purpleGreen; \t            color.b -= purpleGreen; \t            color.r -= yellowBlue; \t            color.g -= yellowBlue; \t            color.b += yellowBlue; \t            gl_FragColor = color;\t        }\t    "),a.call(this,p.hueColor,{hue:t(-1,r,1),greenRed:t(-1,i/5,1),purpleGreen:t(-1,o/5,1),yellowBlue:t(-1,n/5,1)}),this}function d(e){var r=e[0],i=e[1],o=e[2],n=e[3];return p.brightnesscontrastSaturationBur=p.brightnesscontrastSaturationBur||new m(null,"            uniform sampler2D texture;            uniform float brightness;            uniform float contrast;            uniform float saturation;            uniform vec2 delta;            varying vec2 texCoord;            "+x+"            void main() {                vec4 color = vec4(0.0);                float total = 0.0;                                /* randomize the lookup values to hide the fixed number of samples */                float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                                for (float t = -30.0; t <= 30.0; t++) {                    float percent = (t + offset - 0.5) / 30.0;                    float weight = 1.0 - abs(percent);                    vec4 sample = texture2D(texture, texCoord + delta * percent);                                        /* switch to pre-multiplied alpha to correctly blur transparent images */                    sample.rgb *= sample.a;                                        color += sample * weight;                    total += weight;                    color.rgb += brightness;                    if (contrast > 0.0) {                        color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;                    } else {                        color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;                    }                    /* saturation adjustment */                    float average = (color.r + color.g + color.b) / 3.0;                    if (saturation > 0.0) {                        color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));                    } else {                        color.rgb += (average - color.rgb) * (-saturation);                    }                }                                gl_FragColor = color / total;                                /* switch back from pre-multiplied alpha */                gl_FragColor.rgb /= gl_FragColor.a + 0.00001;            }        "),a.call(this,p.brightnesscontrastSaturationBur,{brightness:t(-1,r/10,1),contrast:t(-1,i/100,1),saturation:t(-1,o/50,1)}),a.call(this,p.brightnesscontrastSaturationBur,{delta:[n/this.width,0]}),a.call(this,p.brightnesscontrastSaturationBur,{delta:[0,n/this.height]}),this}function f(t){var e=t.length;this.xa=[],this.ya=[],this.u=[],this.y2=[],t.sort(function(t,e){return t[0]-e[0]});for(var r=0;r<e;r++)this.xa.push(t[r][0]),this.ya.push(t[r][1]);this.u[0]=0,this.y2[0]=0;for(var r=1;r<e-1;++r){var i=this.xa[r+1]-this.xa[r-1],o=(this.xa[r]-this.xa[r-1])/i,n=o*this.y2[r-1]+2;this.y2[r]=(o-1)/n;var a=(this.ya[r+1]-this.ya[r])/(this.xa[r+1]-this.xa[r])-(this.ya[r]-this.ya[r-1])/(this.xa[r]-this.xa[r-1]);this.u[r]=(6*a/i-o*this.u[r-1])/n}this.y2[e-1]=0;for(var r=e-2;r>=0;--r)this.y2[r]=this.y2[r]*this.y2[r+1]+this.u[r]}var p,g={};!function(){function t(){}function e(e){return void 0===e.$OES_texture_float_linear$&&Object.defineProperty(e,"$OES_texture_float_linear$",{enumerable:!1,configurable:!1,writable:!1,value:new t}),e.$OES_texture_float_linear$}function r(t){return"OES_texture_float_linear"===t?e(this):n.call(this,t)}function i(){var t=a.call(this);return-1===t.indexOf("OES_texture_float_linear")&&t.push("OES_texture_float_linear"),t}try{var o=document.createElement("canvas").getContext("experimental-webgl")}catch(t){}if(o&&-1===o.getSupportedExtensions().indexOf("OES_texture_float_linear")&&function(t){if(!t.getExtension("OES_texture_float"))return!1;var e=t.createFramebuffer(),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var i=[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=t.createTexture();t.bindTexture(t.TEXTURE_2D,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,2,2,0,t.RGBA,t.FLOAT,new Float32Array(i));var n=t.createProgram(),a=t.createShader(t.VERTEX_SHADER),s=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(a,"\t\t      attribute vec2 vertex;\t\t      void main() {\t\t        gl_Position = vec4(vertex, 0.0, 1.0);\t\t      }\t\t    "),t.shaderSource(s,"\t\t      uniform sampler2D texture;\t\t      void main() {\t\t        gl_FragColor = texture2D(texture, vec2(0.5));\t\t      }\t\t    "),t.compileShader(a),t.compileShader(s),t.attachShader(n,a),t.attachShader(n,s),t.linkProgram(n);var h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0]),t.STREAM_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0);var u=new Uint8Array(4);return t.useProgram(n),t.viewport(0,0,1,1),t.bindTexture(t.TEXTURE_2D,o),t.drawArrays(t.POINTS,0,1),t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,u),127===u[0]||128===u[0]}(o)){var n=WebGLRenderingContext.prototype.getExtension,a=WebGLRenderingContext.prototype.getSupportedExtensions;WebGLRenderingContext.prototype.getExtension=r,WebGLRenderingContext.prototype.getSupportedExtensions=i}}(),g.canvas=function(){var t=document.createElement("canvas");try{p=t.getContext("experimental-webgl",{premultipliedAlpha:!1,preserveDrawingBuffer:!0})}catch(t){p=null}if(!p)throw"This browser does not support WebGL";return t._={gl:p,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null},t.texture=l(r),t.draw=l(o),t.update=l(n),t.replace=l(s),t.contents=l(h),t.getPixelArray=l(u),t.brightnesscontrastSaturationBur=l(d),t.hueColor=l(c),t};var m=function(){function t(t){return"[object Array]"==Object.prototype.toString.call(t)}function e(t){return"[object Number]"==Object.prototype.toString.call(t)}function r(t,e){var r=p.createShader(t);if(p.shaderSource(r,e),p.compileShader(r),!p.getShaderParameter(r,p.COMPILE_STATUS))throw"compile error: "+p.getShaderInfoLog(r);return r}function i(t,e){if(this.vertexAttribute=null,this.texCoordAttribute=null,this.program=p.createProgram(),t=t||o,e=e||n,e="precision highp float;"+e,p.attachShader(this.program,r(p.VERTEX_SHADER,t)),p.attachShader(this.program,r(p.FRAGMENT_SHADER,e)),p.linkProgram(this.program),!p.getProgramParameter(this.program,p.LINK_STATUS))throw"link error: "+p.getProgramInfoLog(this.program)}var o="\t    attribute vec2 vertex;\t    attribute vec2 _texCoord;\t    varying vec2 texCoord;\t    void main() {\t        texCoord = _texCoord;\t        gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);\t    }",n="\t    uniform sampler2D texture;\t    varying vec2 texCoord;\t    void main() {\t        gl_FragColor = texture2D(texture, texCoord);\t    }";return i.prototype.destroy=function(){p.deleteProgram(this.program),this.program=null},i.prototype.uniforms=function(r){p.useProgram(this.program);for(var i in r)if(r.hasOwnProperty(i)){var o=p.getUniformLocation(this.program,i);if(null!==o){var n=r[i];if(t(n))switch(n.length){case 1:p.uniform1fv(o,new Float32Array(n));break;case 2:p.uniform2fv(o,new Float32Array(n));break;case 3:p.uniform3fv(o,new Float32Array(n));break;case 4:p.uniform4fv(o,new Float32Array(n));break;case 9:p.uniformMatrix3fv(o,!1,new Float32Array(n));break;case 16:p.uniformMatrix4fv(o,!1,new Float32Array(n));break;default:throw"dont't know how to load uniform \""+i+'" of length '+n.length}else{if(!e(n))throw'attempted to set uniform "'+i+'" to invalid value '+(n||"undefined").toString();p.uniform1f(o,n)}}}return this},i.prototype.textures=function(t){p.useProgram(this.program);for(var e in t)t.hasOwnProperty(e)&&p.uniform1i(p.getUniformLocation(this.program,e),t[e]);return this},i.prototype.drawRect=function(t,e,r,i){var o=p.getParameter(p.VIEWPORT);e=void 0!==e?(e-o[1])/o[3]:0,t=void 0!==t?(t-o[0])/o[2]:0,r=void 0!==r?(r-o[0])/o[2]:1,i=void 0!==i?(i-o[1])/o[3]:1,null==p.vertexBuffer&&(p.vertexBuffer=p.createBuffer()),p.bindBuffer(p.ARRAY_BUFFER,p.vertexBuffer),p.bufferData(p.ARRAY_BUFFER,new Float32Array([t,e,t,i,r,e,r,i]),p.STATIC_DRAW),null==p.texCoordBuffer&&(p.texCoordBuffer=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,p.texCoordBuffer),p.bufferData(p.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),p.STATIC_DRAW)),null==this.vertexAttribute&&(this.vertexAttribute=p.getAttribLocation(this.program,"vertex"),p.enableVertexAttribArray(this.vertexAttribute)),null==this.texCoordAttribute&&(this.texCoordAttribute=p.getAttribLocation(this.program,"_texCoord"),p.enableVertexAttribArray(this.texCoordAttribute)),p.useProgram(this.program),p.bindBuffer(p.ARRAY_BUFFER,p.vertexBuffer),p.vertexAttribPointer(this.vertexAttribute,2,p.FLOAT,!1,0,0),p.bindBuffer(p.ARRAY_BUFFER,p.texCoordBuffer),p.vertexAttribPointer(this.texCoordAttribute,2,p.FLOAT,!1,0,0),p.drawArrays(p.TRIANGLE_STRIP,0,4)},i.getDefaultShader=function(){return p.defaultShader=p.defaultShader||new i,p.defaultShader},i}();f.prototype.interpolate=function(t){for(var e=this.ya.length,r=0,i=e-1;i-r>1;){var o=i+r>>1;this.xa[o]>t?i=o:r=o}var n=this.xa[i]-this.xa[r],a=(this.xa[i]-t)/n,s=(t-this.xa[r])/n;return a*this.ya[r]+s*this.ya[i]+((a*a*a-a)*this.y2[r]+(s*s*s-s)*this.y2[i])*(n*n)/6};var v=function(){function t(t,e,r,i){this.gl=p,this.id=p.createTexture(),this.width=t,this.height=e,this.format=r,this.type=i,p.bindTexture(p.TEXTURE_2D,this.id),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),t&&e&&p.texImage2D(p.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null)}function e(t){null==r&&(r=document.createElement("canvas")),r.width=t.width,r.height=t.height;var e=r.getContext("2d");return e.clearRect(0,0,r.width,r.height),e}t.fromElement=function(e){var r=new t(0,0,p.RGBA,p.UNSIGNED_BYTE);return r.loadContentsOf(e),r},t.prototype.loadContentsOf=function(t){this.width=t.width||t.videoWidth,this.height=t.height||t.videoHeight,p.bindTexture(p.TEXTURE_2D,this.id),p.texImage2D(p.TEXTURE_2D,0,this.format,this.format,this.type,t)},t.prototype.initFromBytes=function(t,e,r){this.width=t,this.height=e,this.format=p.RGBA,this.type=p.UNSIGNED_BYTE,p.bindTexture(p.TEXTURE_2D,this.id),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,t,e,0,p.RGBA,this.type,new Uint8Array(r))},t.prototype.destroy=function(){p.deleteTexture(this.id),this.id=null},t.prototype.use=function(t){p.activeTexture(p.TEXTURE0+(t||0)),p.bindTexture(p.TEXTURE_2D,this.id)},t.prototype.unuse=function(t){p.activeTexture(p.TEXTURE0+(t||0)),p.bindTexture(p.TEXTURE_2D,null)},t.prototype.ensureFormat=function(t,e,r,i){if(1==arguments.length){var o=arguments[0];t=o.width,e=o.height,r=o.format,i=o.type}t==this.width&&e==this.height&&r==this.format&&i==this.type||(this.width=t,this.height=e,this.format=r,this.type=i,p.bindTexture(p.TEXTURE_2D,this.id),p.texImage2D(p.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null))},t.prototype.drawTo=function(t){if(p.framebuffer=p.framebuffer||p.createFramebuffer(),p.bindFramebuffer(p.FRAMEBUFFER,p.framebuffer),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,this.id,0),p.checkFramebufferStatus(p.FRAMEBUFFER)!==p.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");p.viewport(0,0,this.width,this.height),t(),p.bindFramebuffer(p.FRAMEBUFFER,null)};var r=null;return t.prototype.fillUsingCanvas=function(t){return t(e(this)),this.format=p.RGBA,this.type=p.UNSIGNED_BYTE,p.bindTexture(p.TEXTURE_2D,this.id),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,r),this},t.prototype.toImage=function(t){this.use(),m.getDefaultShader().drawRect();var i=this.width*this.height*4,o=new Uint8Array(i),n=e(this),a=n.createImageData(this.width,this.height);p.readPixels(0,0,this.width,this.height,p.RGBA,p.UNSIGNED_BYTE,o);for(var s=0;s<i;s++)a.data[s]=o[s];n.putImageData(a,0,0),t.src=r.toDataURL()},t.prototype.swapWith=function(t){var e;e=t.id,t.id=this.id,this.id=e,e=t.width,t.width=this.width,this.width=e,e=t.height,t.height=this.height,this.height=e,e=t.format,t.format=this.format,this.format=e},t}(),x="\t    float random(vec3 scale, float seed) {\t        /* use the fragment position for a different seed per-pixel */\t        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\t    }\t";return g}()},function(t,e,r){"use strict";function i(t){for(var e=t.getContext("2d"),r=e.getImageData(0,0,t.width,t.height),i=e.createImageData(t.width,t.height),o=r.width,n=r.height,a=0;a<o;a++)for(var u=0;u<n;u++){var l=s(r,a,u);h(i,o-1-a,u,l)}e.putImageData(i,0,0)}function o(t,e,r){if(t&&"function"==typeof t){var i=arguments,o=i.length;if(1==o)return t.apply(window);if(2==o)return Array.isArray(e)?t.apply(window,e):t.apply(e);if(3==o)return t.apply(e||window,r)}}function n(t,e){for(var r=window.atob(t.split(",")[1]),i=new ArrayBuffer(r.length),o=new Uint8Array(i),n=0;n<r.length;n++)o[n]=r.charCodeAt(n);return new Blob([i],{type:e})}function a(t){return function(e){var r=new XMLHttpRequest,i=e.url,o=e.data,n=null;"GET"===t&&o&&(i+=l.stringify(o,-1==i.indexOf("?")?"?":"&"));var a=new Promise(function(t,e){r.addEventListener("load",function(){var e=(r.getResponseHeader("content-type"),"text"!=r.responseType&&""!=r.responseType?r.response:r.responseText);t(e)}),r.addEventListener("error",function(t){return e(t)})});return r.open(t,i,!0),"GET"!==t&&(o&&o.append?n=o:(n=JSON.stringify(o),r.setRequestHeader("Content-Type","application/json"))),e.type&&(r.responseType=e.type),r.send(n),a}}function s(t,e,r){var i=t.width,o=(t.height,t.data),n=[];return n[0]=o[4*(r*i+e)],n[1]=o[4*(r*i+e)+1],n[2]=o[4*(r*i+e)+2],n[3]=o[4*(r*i+e)+3],n}function h(t,e,r,i){var o=t.width,n=(t.height,t.data);n[4*(r*o+e)]=i[0],n[4*(r*o+e)+1]=i[1],n[4*(r*o+e)+2]=i[2],n[4*(r*o+e)+3]=i[3]}r.d(e,"b",function(){return c}),e.d=i,e.c=o,e.a=n;var u=function(){function t(t,e){var r=[],i=!0,o=!1,n=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);i=!0);}catch(t){o=!0,n=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw n}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l={parse:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search;if(!t)return{};var e="?"===t[0]?t.substring(1):t,r={};return e.split("&").forEach(function(t){var e=t.split("="),i=u(e,2),o=i[0],n=i[1];o&&(r[o]=n)}),r},stringify:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"?",r=Object.keys(t).map(function(e){return e+"="+encodeURIComponent(t[e]||"")}).join("&");return r?e+r:""}},c={get:a("GET"),post:a("POST")}}])});
//# sourceMappingURL=pic-tune.min.js.map